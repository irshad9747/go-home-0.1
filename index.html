<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Game</title>
  <style>
    body {
      display: flex; flex-direction: column;
      align-items: center; margin-top: 20px;
      font-family: sans-serif;
      background-color: rgb(152, 194, 136);
    }
    .canvas {
      height: 600px; width: 400px;
      background: rgb(28, 101, 46);
      display: grid;
      grid-template-rows: repeat(30, 1fr);
      grid-template-columns: repeat(20, 1fr);
      border: 7px solid #0c581d;
      border-radius: 10px;
      position: relative;
    }
    .bg{
      grid-area: 1/1/31/21;
    }
    #player {
      grid-area: 5 / 4 / 6 / 5; 
      z-index: 1;
      position: absolute;
    }
    #player img {
      position: relative;
      width: 33px; height: 35px;
      top: -12px;
      right: -20px;
    }
    #sc {
      position: absolute; top: 5px; left: 50%;
      transform: translateX(-50%);
      color: rgb(211,255,233);
      text-shadow: 0 0 10px rgb(104,210,255);
      z-index: 3;
    }
    .emydiv{position: absolute;
       grid-area: 10 / 15 / 11 / 16; 
      z-index: 1;
    }
    .emy{
      position: relative;
      top: -12px;
      right: -14px;
      height: 35px;
      
    }
  </style>
</head>
<body>
  
  <h5 id="sc">0</h5>
  <div class="canvas">
    <div class="bg">
      <img class="rrr" src="./bg.png" style="width:100%; height:100%;">
    </div>
    <div id="player"><img class="p" src="./player.png"></div>
    <div class="emydiv"><img class="emy" id="emy" src="./emy.png" alt=""></div>
  </div>
  <!-- <div class="control">
    <button class="bton" onclick="moveemy(-1,  0)">↑</button>
    <div>
      <button class="bton" onclick="moveemy( 0, -1)">←</button>
      <button class="bton" onclick="moveemy( 0, 1)">→</button>
    </div>
    <button class="bton" onclick="moveemy(1,  0)">↓</button>
  </div> -->
  <script>
    let rs = 5, cs = 4;       
    let rsemy = 10, csemy = 15;          
    let s = 0;                   
    const ROWS = 30, COLS = 20;

    let map = [
  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0],
  [0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0],
  [0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0],
  [0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0],
  [1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0],
  [1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0],
  [1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0],
  [1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0],
  [0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
  [0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
  [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0],
  [0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0],
  [0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0],
  [0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0],
  [0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0],
  [0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0],
  [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 0, 0, 0, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 1, 1, 0, 0, 0],
  [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 1, 1, 0, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0], 
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0]
];

    function drawPlayer() {
      const pl = document.getElementById('player');
      pl.style.gridArea = `${rs} / ${cs} / ${rs+1} / ${cs+1}`;
    }

        function drawemy() {
  const ep = document.getElementById('emy');
  ep.parentElement.style.gridArea = `${rsemy} / ${csemy} / ${rsemy+1} / ${csemy+1}`;
}


    function score() {
      document.getElementById('sc').textContent = s;
    }

    function onGoalReached() {
      const image = document.getElementsByClassName("rrr")[0];
    image.src = "./menu.png";
     const em = document.getElementsByClassName("emy")[0];
    em.src = "./empty.png"; 
      const p = document.getElementsByClassName("p")[0];
    p.src = "./empty.png";
     drawPlayer()
    }
    function fail() {
      const image = document.getElementsByClassName("rrr")[0];
    image.src = "./fail.png";
    const em = document.getElementsByClassName("p")[0];
    em.src = "./empty.png";
 
      const p = document.getElementsByClassName("emy")[0];
    p.src = "./empty.png"; 
     drawPlayer()
    }
    function canStep(r, c) {
      return r >= 1 && r <= ROWS
          && c >= 1 && c <= COLS
          && map[r-1][c-1] !== 0;
    }

    function move(dr, dc) {
      const nr = rs + dr, nc = cs + dc;
      if (!canStep(nr, nc)) return;  
      rs = nr; cs = nc;
      s++;                             
      drawPlayer();
      score();

      if (map[rs-1][cs-1] === 2) {
        onGoalReached();
      }
    }

        function moveemy(dr, dc) {
      const nr = rsemy + dr, nc = csemy + dc;
      if (!canStep(nr, nc)) return;  
      rsemy = nr; csemy = nc;
      s--; 
      score();                            
      drawemy();
       if(rs==rsemy&&cs==csemy){
       fail()
    }    
    }

    document.addEventListener('keydown', e => {
      switch (e.key) {
        case 'w':    move(-1,  0); break;
        case 's':  move( 1,  0); break;
        case 'a':  move( 0, -1); break;
        case 'd': move( 0,  1); break;
      }
    });
    document.addEventListener('keydown', e => {
      switch (e.key) {
        case 	"ArrowUp":    moveemy(-1,  0); break;
        case "ArrowDown":  moveemy( 1,  0); break;
        case "ArrowLeft":  moveemy( 0, -1); break;
        case "ArrowRight": moveemy( 0,  1); break;
      }
    });

    drawPlayer();
    score();
  </script>
</body>
</html>
